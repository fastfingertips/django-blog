{% extends "layout.html" %}

{% block body %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h2 class="fw-bold m-0">Recent Articles</h2>
  {% if request.user.is_authenticated %}
  <a href="{% url 'article_urls:article_add' %}" class="btn btn-primary d-flex align-items-center gap-2">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-plus-lg"
      viewBox="0 0 16 16">
      <path fill-rule="evenodd"
        d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z" />
    </svg>
    New Article
  </a>
  {% endif %}
</div>

{% if articles %}
<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
  {% for article in articles %}
  <div class="col">
    <div class="card h-100">
      {% if article.article_image %}
      <img src="{{ article.article_image.url }}" class="card-img-top" alt="{{ article.title }}"
        style="height: 200px; object-fit: cover;">
      {% else %}
      <div style="height: 200px; background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);"
        class="d-flex align-items-center justify-content-center">
        <span class="text-white-50">No Image</span>
      </div>
      {% endif %}
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <span class="badge bg-secondary-subtle text-secondary">{{ article.created_at|date:"M d, Y" }}</span>
          <span class="text-white-50 small d-flex align-items-center gap-1">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-chat-dots"
              viewBox="0 0 16 16">
              <path
                d="M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z" />
              <path
                d="m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9.06 9.06 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.437 10.437 0 0 1-.524 2.318l-.003.011a10.722 10.722 0 0 1-.244.637c-.079.186.074.394.273.362a21.673 21.673 0 0 0 .693-.125zm.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6c0 3.193-3.004 6-7 6a8.06 8.06 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a10.97 10.97 0 0 0 .398-2z" />
            </svg>
            {{ article.comments.count }}
          </span>
        </div>
        <h5 class="card-title fw-bold">
          <a href="{% url 'article_urls:article_detail' article.id %}"
            class="text-white link-underline-opacity-0 link-underline-opacity-100-hover">
            {{ article.title }}
          </a>
        </h5>
        <div class="card-text text-white-50 mb-3 small">
          {{ article.content|striptags|truncatechars:100 }}
        </div>
      </div>
      <div class="card-footer bg-transparent border-top border-white-10 py-3">
        <div class="d-flex align-items-center gap-2">
          {% if article.author.profile_picture %}
          <img src="{{ article.author.profile_picture.url }}" class="rounded-circle" width="30" height="30"
            style="object-fit: cover;">
          {% else %}
          <div class="rounded-circle bg-primary-subtle d-flex align-items-center justify-content-center"
            style="width: 30px; height: 30px;">
            <span class="small text-primary fw-bold">{{ article.author.username.0|upper }}</span>
          </div>
          {% endif %}
          <a href="{% url 'user_urls:profile' article.author.username %}" class="small text-white-50 link-light">@{{
            article.author.username }}</a>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% else %}
<div class="p-5 text-center bg-dark rounded-4 shadow-sm border border-secondary">
  <div class="p-4 glass-box rounded-3 d-inline-block mb-3">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor"
      class="bi bi-journal-x text-white-50" viewBox="0 0 16 16">
      <path
        d="M6.146 6.146a.5.5 0 0 1 .708 0L8 7.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 8l1.147 1.146a.5.5 0 0 1-.708.708L8 8.707l-1.146 1.147a.5.5 0 0 1-.708-.708L7.293 8 6.146 6.854a.5.5 0 0 1 0-.708z" />
      <path
        d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM2 2a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1H2z" />
      <path d="M2 5v-.5a.5.5 0 0 1 1 0V5h12v.5a.5.5 0 0 1-1 0V5H2z" />
    </svg>
  </div>
  <h4 class="fw-bold">No articles yet</h4>
  <p class="text-white-50">Be the first to share your thoughts with the world.</p>
  {% if request.user.is_authenticated %}
  <a href="{% url 'article_urls:article_add' %}" class="btn btn-primary px-4">Start Writing</a>
  {% else %}
  <a href="{% url 'login' %}" class="btn btn-outline-light px-4">Login to Write</a>
  {% endif %}
</div>
{% endif %}
{% endblock %}