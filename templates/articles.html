{% extends "layout.html" %}

{% block body %}
<div class="text-center mb-5 pb-5 border-bottom">
  <h1 class="display-4">articles</h1>
  <p class="text-secondary">a collection of thoughts and stories.</p>
  {% if request.user.is_authenticated %}
  <a href="{% url 'article_urls:article_add' %}" class="btn btn-primary mt-2">new post</a>
  {% endif %}
</div>

{% if articles %}
<div class="article-list">
  {% for article in articles %}
  <article class="text-center mb-5">
    <header>
      <h2 class="h1">
        <a href="{% url 'article_urls:article_detail' article.id %}"
          class="text-decoration-none text-reset link-dim article-title">
          {{ article.title }}
        </a>
      </h2>
      <div class="small text-secondary mt-2 tracking-widest text-none">
        Published {{ article.created_at|date:"F d, Y" }} by <a href="{% url 'user_urls:profile' article.author.username %}" class="text-reset">@{{ article.author.username }}</a>
      </div>
    </header>
    <div class="mt-3 text-secondary">
      {{ article.content|striptags|truncatechars:150 }}
    </div>
    <footer class="mt-3">
      <a href="{% url 'article_urls:article_detail' article.id %}" class="link-btn tracking-widest">read
        more</a>
    </footer>
  </article>
  {% endfor %}
</div>

{% if is_paginated %}
<nav class="d-flex justify-content-center gap-4 py-5 small border-top">
  {% if page_obj.has_previous %}
  <a href="?page={{ page_obj.previous_page_number }}" class="text-reset text-decoration-none opacity-50 link-dim">&larr;
    newer</a>
  {% else %}
  <span class="opacity-10">&larr; newer</span>
  {% endif %}

  <span class="opacity-25">{{ page_obj.number }} / {{ paginator.num_pages }}</span>

  {% if page_obj.has_next %}
  <a href="?page={{ page_obj.next_page_number }}" class="text-reset text-decoration-none opacity-50 link-dim">older
    &rarr;</a>
  {% else %}
  <span class="opacity-10">older &rarr;</span>
  {% endif %}
</nav>
{% endif %}
{% else %}
<div class="py-5 text-center">
  <p class="lead text-secondary">Nothing has been published here yet.</p>
  {% if request.user.is_authenticated %}
  <a href="{% url 'article_urls:article_add' %}" class="btn btn-primary">create first post</a>
  {% endif %}
</div>
{% endif %}

<style>
  .tracking-widest {
    letter-spacing: 0.15em;
  }

  .link-dim {
    transition: opacity 0.2s;
  }

  .link-dim:hover {
    opacity: 0.7;
  }

  article {
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }
</style>
{% endblock %}