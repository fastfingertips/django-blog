{% extends "layout.html" %}

{% block body %}
<div class="text-center-wrapper py-5">
  <header class="mb-5">
    <h1 class="display-4 fw-bold">search results</h1>
    <p class="text-secondary">filtering for: "<em>{{ query }}</em>"</p>
  </header>

  <div class="w-100" style="max-width: 600px;">
    <!-- Articles -->
    <section class="mb-5">
      <h3 class="h5 text-lowercase tracking-widest border-bottom pb-2 mb-4">Articles ({{
        titles|length|add:contents|length }})</h3>
      {% if titles or contents %}
      <ul class="list-unstyled">
        {% for title in titles %}
        <li class="mb-3">
          <a href="{% url 'article_urls:article_detail' title.id %}"
            class="text-reset text-decoration-none fw-bold link-dim d-block">{{ title.title }}</a>
          <small class="text-secondary text-lowercase tracking-widest">Title Match</small>
        </li>
        {% endfor %}
        {% for content in contents %}
        <li class="mb-3">
          <a href="{% url 'article_urls:article_detail' content.id %}"
            class="text-reset text-decoration-none link-dim d-block">{{ content.content|striptags|truncatechars:100
            }}</a>
          <small class="text-secondary text-lowercase tracking-widest">Content Match</small>
        </li>
        {% endfor %}
      </ul>
      {% else %}
      <p class="text-secondary small italic">no matching articles found.</p>
      {% endif %}
    </section>

    <!-- Users -->
    <section class="mb-5">
      <h3 class="h5 text-lowercase tracking-widest border-bottom pb-2 mb-4">Users ({{ users|length }})</h3>
      {% if users %}
      <div class="d-flex flex-wrap justify-content-center gap-3">
        {% for user in users %}
        <a href="{% url 'user_urls:profile' user.username %}" class="badge text-decoration-none p-2 px-3">@{{
          user.username }}</a>
        {% endfor %}
      </div>
      {% else %}
      <p class="text-secondary small italic">no users found.</p>
      {% endif %}
    </section>

    <!-- Comments -->
    <section class="mb-5">
      <h3 class="h5 text-lowercase tracking-widest border-bottom pb-2 mb-4">Comments ({{ comments|length }})</h3>
      {% if comments %}
      <ul class="list-unstyled">
        {% for comment in comments %}
        <li class="mb-3 border-start ps-3">
          <span class="text-secondary small d-block">in Re: {{ comment.article.title }}</span>
          <a href="{% url 'article_urls:article_detail' comment.article.id %}"
            class="text-reset text-decoration-none italic link-dim">"{{ comment.comment_content|truncatechars:80 }}"</a>
        </li>
        {% endfor %}
      </ul>
      {% else %}
      <p class="text-secondary small italic">no comments matches your query.</p>
      {% endif %}
  </div>
</div>
</div>

<style>
  .tracking-widest {
    letter-spacing: 0.15em;
  }

  .italic {
    font-style: italic;
  }

  .link-dim:hover {
    opacity: 0.7;
  }
</style>
{% endblock %}